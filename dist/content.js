const l=async()=>{const r=Array.from(document.querySelectorAll("h1, h2, h3, h4")).map(t=>({level:t.tagName,text:t.innerText.trim()})).filter(t=>t.text.length>0),s=Array.from(document.querySelectorAll("img")).filter(t=>t.src.startsWith("http")&&t.width>20),n=await Promise.all(s.map(async t=>{const i=!t.alt||t.alt.length<5;let a=null;if(i)try{const e=await chrome.runtime.sendMessage({action:"PROCESS_IMAGE",payload:{imageUri:t.src}});a=e==null?void 0:e.description}catch{a="Processing error."}return{src:t.src,alt:t.alt||"⚠️ Missing Alt Text",isAccessible:!!t.alt&&!i,aiInterpretedText:a}}));return{title:document.title,headings:r,images:n,url:window.location.href}};chrome.runtime.onMessage.addListener((r,s,n)=>{if(r.action==="SCAN_PAGE")return l().then(t=>{n(t)}),!0});
